<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GX.Sammim | Dhaka Time</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+Bengali:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --glass: rgba(255, 255, 255, 0.05);
            --gold: #ffcc00;
            --neon: #00d2ff;
        }

        body {
            margin: 0; background: #050a14; color: white;
            font-family: 'Noto Serif Bengali', serif; 
            display: flex; justify-content: center;
        }

        .app { width: 100%; max-width: 400px; padding: 15px; }

        .city-label {
            background: var(--glass); border: 1px solid var(--neon);
            padding: 10px; border-radius: 10px; text-align: center;
            color: var(--neon); margin-bottom: 15px; font-weight: bold;
            box-shadow: 0 0 10px rgba(0, 210, 255, 0.2);
        }

        #clock { 
            font-size: 3.2rem; text-align: center; margin: 10px 0; 
            font-weight: 800; color: #fff; text-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
        }

        .card {
            background: var(--glass); border-radius: 15px; padding: 15px; margin-bottom: 20px;
            border: 1px solid rgba(0, 210, 255, 0.3); box-shadow: 0 0 15px rgba(0, 210, 255, 0.2); backdrop-filter: blur(10px);
        }

        .header-design { text-align: center; margin-bottom: 20px; }
        .mosque-main { font-size: 55px; color: var(--neon); filter: drop-shadow(0 0 10px var(--neon)); }
        .neon-line { height: 2px; width: 60%; background: var(--neon); margin: 10px auto; box-shadow: 0 0 10px var(--neon); }
        .developer-name { font-size: 19px; font-weight: bold; color: #fff; }

        .ramadan-combined { display: flex; justify-content: space-around; text-align: center; align-items: center; }
        .divider { width: 1px; height: 40px; background: rgba(0, 210, 255, 0.3); }
        .ramadan-box span { font-size: 1.5rem; color: var(--gold); font-weight: bold; display: block; margin-top: 5px; }
        .ramadan-box p { font-size: 0.85rem; color: #00d2ff; margin: 0; }

        .time-row { display: flex; justify-content: space-between; padding: 15px 5px; border-bottom: 1px solid #222; cursor: pointer; }
        .status-highlight { color: var(--neon); font-weight: bold; }
        .next-time-inline { color: var(--gold); font-weight: bold; margin-left: 5px; }

        .modal {
            display: none; position: fixed; z-index: 1000; left: 0; top: 0;
            width: 100%; height: 100%; background-color: rgba(0,0,0,0.92); backdrop-filter: blur(8px);
        }
        .modal-content {
            background: #0a111e; margin: 5% auto; padding: 20px; border: 1px solid var(--neon);
            width: 90%; max-width: 380px; border-radius: 20px; box-shadow: 0 0 30px var(--neon);
            position: relative; max-height: 80vh; overflow-y: auto;
        }
        .close-btn { color: white; float: right; font-size: 28px; font-weight: bold; cursor: pointer; }

        .list-item {
            display: flex; justify-content: space-between; padding: 12px 5px;
            border-bottom: 1px solid rgba(255,255,255,0.1); font-size: 11px; align-items: center;
        }
        .rakat-info { max-height: 0; opacity: 0; overflow: hidden; background: rgba(0, 210, 255, 0.05); transition: all 0.3s; text-align: center; }
        .show-rakat { max-height: 100px; opacity: 1; padding: 10px; border: 1px solid var(--neon); margin: 5px 0; border-radius: 8px; }
    </style>
</head>
<body>
    <div class="app">
        <div class="header-design">
            <div class="mosque-container">
                <i class="fas fa-mosque mosque-main"></i>
            </div>
            <div class="neon-line"></div>
            <h2 class="developer-name">GX.Sammim | Dhaka Time</h2>
            <div class="neon-line-bottom"></div>
        </div>

        <div class="city-label">
            <i class="fas fa-map-marker-alt"></i> ঢাকা জেলা (সরকারি সূচী)
        </div>

        <div class="card clock-card glow">
            <h2 id="clock">00:00:00</h2>
            <p id="today">লোড হচ্ছে...</p>
            <p id="hijriDate" class="gold-text"></p>
        </div>

        <div class="card ramadan-combined glow" onclick="showMonthlySchedule()" style="cursor: pointer;">
            <div class="ramadan-box">
                <p><i class="fas fa-sun"></i> সেহরি শেষ</p>
                <span id="Sehri">--:--</span>
            </div>
            <div class="divider"></div>
            <div class="ramadan-box">
                <p><i class="fas fa-moon"></i> ইফতার</p>
                <span id="Iftar">--:--</span>
            </div>
        </div>

        <div class="card status-card glow" onclick="toggleStatusView()" style="cursor: pointer;">
            <div class="status-wrapper">
                <span id="prayerStatus" class="status-highlight">লোড হচ্ছে...</span>
                <span id="nextTime" class="next-time-inline"></span>
            </div>
        </div>

        <div class="card list-card glow">
            <h3 class="list-title">নামাজের সময়সূচী (ঢাকা)</h3>
            <div class="prayer-list">
                <div class="time-row" onclick="toggleRakat('fajr-r')"><span>ফজর</span><span id="Fajr">--:--</span></div>
                <div id="fajr-r" class="rakat-info">ফজর: ৪ রাকাত (২ সুন্নাত, ২ ফরজ)</div>
                <div class="time-row" onclick="toggleRakat('dhuhr-r')"><span>যোহর</span><span id="Dhuhr">--:--</span></div>
                <div id="dhuhr-r" class="rakat-info">যোহর: ১২ রাকাত (৪ সুন্নাত, ৪ ফরজ, ২ সুন্নাত, ২ নফল)</div>
                <div class="time-row" onclick="toggleRakat('asr-r')"><span>আসর</span><span id="Asr">--:--</span></div>
                <div id="asr-r" class="rakat-info">আসর: ৮ রাকাত (৪ সুন্নাত, ৪ ফরজ)</div>
                <div class="time-row" onclick="toggleRakat('maghrib-r')"><span>মাগরিব</span><span id="Maghrib">--:--</span></div>
                <div id="maghrib-r" class="rakat-info">মাগরিব: ৭ রাকাত (৩ ফরজ, ২ সুন্নাত, ২ নফল)</div>
                <div class="time-row" onclick="toggleRakat('isha-r')"><span>এশা</span><span id="Isha">--:--</span></div>
                <div id="isha-r" class="rakat-info">এশা: ১৭ রাকাত (৪ সুন্নাত, ৪ ফরজ, ২ সুন্নাত, ২ নফল, ৩ বিতর, ২ নফল)</div>
            </div>
        </div>
    </div>

    <div id="monthlyModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <h3 id="modalTitle" style="color: var(--neon); text-align: center; font-size: 18px;">ঢাকার সময়সূচী</h3>
            <div id="monthlyList" class="monthly-list-container"></div>
            <p style="font-size: 10px; text-align: center; color: #aaa; margin-top: 10px;">(১০ সেকেন্ড পর অটো বন্ধ হবে)</p>
        </div>
    </div>

    <script>
        let statusView = 0;
        let timeOffset = 0;
        let pTimes = {};
        let modalTimer;

        const ramadanStatic = {
            "19 Feb": { s: "05:12", i: "17:58", h: "১" }, "20 Feb": { s: "05:11", i: "17:58", h: "২" },
            "21 Feb": { s: "05:11", i: "17:59", h: "৩" }, "22 Feb": { s: "05:10", i: "17:59", h: "৪" },
            "23 Feb": { s: "05:09", i: "18:00", h: "৫" }, "24 Feb": { s: "05:08", i: "18:00", h: "৬" },
            "25 Feb": { s: "05:08", i: "18:01", h: "৭" }, "26 Feb": { s: "05:07", i: "18:01", h: "৮" },
            "27 Feb": { s: "05:06", i: "18:02", h: "৯" }, "28 Feb": { s: "05:05", i: "18:02", h: "১০" },
            "01 Mar": { s: "05:05", i: "18:03", h: "১১" }, "02 Mar": { s: "05:04", i: "18:03", h: "১২" },
            "03 Mar": { s: "05:03", i: "18:04", h: "১৩" }, "04 Mar": { s: "05:02", i: "18:04", h: "১৪" },
            "05 Mar": { s: "05:01", i: "18:05", h: "১৫" }, "06 Mar": { s: "05:00", i: "18:05", h: "১৬" },
            "07 Mar": { s: "04:59", i: "18:06", h: "১৭" }, "08 Mar": { s: "04:58", i: "18:06", h: "১৮" },
            "09 Mar": { s: "04:57", i: "18:07", h: "১৯" }, "10 Mar": { s: "04:57", i: "18:07", h: "২০" },
            "11 Mar": { s: "04:56", i: "18:07", h: "২১" }, "12 Mar": { s: "04:55", i: "18:08", h: "২২" },
            "13 Mar": { s: "04:54", i: "18:08", h: "২৩" }, "14 Mar": { s: "04:53", i: "18:09", h: "২৪" },
            "15 Mar": { s: "04:52", i: "18:09", h: "২৫" }, "16 Mar": { s: "04:51", i: "18:10", h: "২৬" },
            "17 Mar": { s: "04:50", i: "18:10", h: "২৭" }, "18 Mar": { s: "04:49", i: "18:10", h: "২৮" },
            "19 Mar": { s: "04:48", i: "18:11", h: "২৯" }, "20 Mar": { s: "04:47", i: "18:11", h: "৩০" }
        };

        async function initApp() {
            await syncTime();
            loadData();
            setInterval(updateClock, 1000);
        }

        async function syncTime() {
            try {
                const res = await fetch('https://worldtimeapi.org/api/timezone/Asia/Dhaka');
                const data = await res.json();
                timeOffset = new Date(data.datetime).getTime() - Date.now();
            } catch (e) { timeOffset = 0; }
        }

        function getCorrectNow() { return new Date(Date.now() + timeOffset); }

        function loadData() {
            const now = getCorrectNow();
            const dateKey = now.toLocaleDateString('en-GB', { day: '2-digit', month: 'short' });

            if (ramadanStatic[dateKey]) {
                const d = ramadanStatic[dateKey];
                pTimes.Fajr = d.s;
                pTimes.Maghrib = d.i;
                document.getElementById("Sehri").innerText = t12(d.s);
                document.getElementById("Iftar").innerText = t12(d.i);
                document.getElementById("hijriDate").innerText = `${d.h} রমজান, ১৪৪৭ হিজরী`;
                fetchPrayers(true);
            } else {
                fetchPrayers(false);
            }
        }

        async function fetchPrayers(isRamadan) {
            const url = `https://api.aladhan.com/v1/timingsByCity?city=Dhaka&country=Bangladesh&method=1`;
            try {
                const res = await fetch(url);
                const data = await res.json();
                const api = data.data.timings;

                if (!isRamadan) {
                    pTimes = api;
                    document.getElementById("Sehri").innerText = t12(api.Fajr);
                    document.getElementById("Iftar").innerText = t12(api.Maghrib);
                    document.getElementById("hijriDate").innerText = `${data.data.date.hijri.day} ${data.data.date.hijri.month.en} হিজরী`;
                } else {
                    pTimes.Dhuhr = api.Dhuhr;
                    pTimes.Asr = api.Asr;
                    pTimes.Isha = api.Isha;
                }

                document.getElementById("Fajr").innerText = t12(pTimes.Fajr);
                document.getElementById("Dhuhr").innerText = t12(pTimes.Dhuhr);
                document.getElementById("Asr").innerText = t12(pTimes.Asr);
                document.getElementById("Maghrib").innerText = t12(pTimes.Maghrib);
                document.getElementById("Isha").innerText = t12(pTimes.Isha);
                updateStatus();
            } catch (e) {}
        }

        function updateClock() {
            const now = getCorrectNow();
            document.getElementById("clock").innerText = now.toLocaleTimeString("bn-BD");
            document.getElementById("today").innerText = now.toLocaleDateString("bn-BD", { weekday:'long', year:'numeric', month:'long', day:'numeric' });
            updateStatus();
        }

        function t12(t) {
            if(!t) return "--:--";
            let [h, m] = t.split(' ')[0].split(':').map(Number);
            let p = h >= 12 ? 'PM' : 'AM';
            h = h % 12 || 12;
            return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')} ${p}`;
        }

        function updateStatus() {
            if (!pTimes.Fajr) return;
            const now = getCorrectNow();
            const sch = [{n:"ফজর", t:pTimes.Fajr}, {n:"যোহর", t:pTimes.Dhuhr}, {n:"আসর", t:pTimes.Asr}, {n:"মাগরিব", t:pTimes.Maghrib}, {n:"এশা", t:pTimes.Isha}];
            
            let target = null, label = "";
            for (let p of sch) {
                let [h, m] = p.t.split(':');
                let d = new Date(now); d.setHours(h, m, 0);
                if (d > now) { 
                    if(statusView === 0) { label = `পরবর্তী নামাজ: ${p.n}`; target = d; }
                    break; 
                }
            }

            if (statusView === 1) { label = "সেহরির বাকি:"; target = getTarget(pTimes.Fajr); }
            else if (statusView === 2) { label = "イফতারের বাকি:"; target = getTarget(pTimes.Maghrib); }

            if (target) {
                let diff = Math.floor((target - now) / 60000);
                document.getElementById("prayerStatus").innerText = label;
                document.getElementById("nextTime").innerText = `(বাকি: ${Math.floor(diff/60)}ঘঃ ${diff%60}মিঃ)`;
            }
        }

        function getTarget(timeStr) {
            const now = getCorrectNow();
            let [h, m] = timeStr.split(':');
            let t = new Date(now); t.setHours(h, m, 0);
            if (now > t) t.setDate(t.getDate() + 1);
            return t;
        }

        function showMonthlySchedule() {
            const container = document.getElementById("monthlyList");
            container.innerHTML = "";
            const now = getCorrectNow();

            if (now.getMonth() <= 2) { 
                document.getElementById("modalTitle").innerText = "ঢাকার সরকারি রমজান সূচী ২০২৬";
                Object.keys(ramadanStatic).forEach(date => {
                    const item = ramadanStatic[date];
                    const row = document.createElement("div");
                    row.className = "list-item";
                    row.innerHTML = `<span class="day-num">${item.h}</span><span style="flex:1">${date}</span><span style="color:var(--gold)">সেহরি: ${t12(item.s)}</span><span style="color:var(--neon); margin-left:10px;">ইফতার: ${t12(item.i)}</span>`;
                    container.appendChild(row);
                });
            } else {
                document.getElementById("modalTitle").innerText = "চলতি মাসের ঢাকার সূচী";
                container.innerHTML = "<p style='text-align:center'>API থেকে সময় লোড হচ্ছে...</p>";
            }
            document.getElementById("monthlyModal").style.display = "block";
            clearTimeout(modalTimer);
            modalTimer = setTimeout(closeModal, 10000);
        }

        function closeModal() { document.getElementById("monthlyModal").style.display = "none"; }
        function toggleStatusView() { statusView = (statusView + 1) % 3; updateStatus(); }
        function toggleRakat(id) { document.getElementById(id).classList.toggle('show-rakat'); }

        window.onload = initApp;
    </script>
</body>
</html>
